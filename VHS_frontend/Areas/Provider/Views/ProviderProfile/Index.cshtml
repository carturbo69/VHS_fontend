@model VHS_frontend.Areas.Provider.Models.Profile.ProviderProfileDTO
@inject IConfiguration Configuration
@{
    ViewData["Title"] = "Thông tin nhà cung cấp";
    Layout = "~/Areas/Provider/Views/_ProviderLayout.cshtml";
}
@using VHS_frontend.Helpers

@section Styles {
    <link rel="stylesheet" href="~/css/provider-profile-index.css" asp-append-version="true" />
}

@functions {
    string GetStatusText(string status)
    {
        var statusLower = status?.ToLower() ?? "";
        return statusLower switch
        {
            "approved" => "Đã duyệt",
            "pending" => "Chờ duyệt",
            "rejected" => "Từ chối",
            _ => status ?? "Chưa xác định"
        };
    }
}

<div class="provider-profile">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-11 col-xl-10">
                <!-- Header Section -->
                <div class="profile-page-header">
                    <div class="header-icon">
                        <i class="bi bi-person-circle"></i>
                    </div>
                    <div class="header-content">
                        <h1 class="header-title">Thông tin nhà cung cấp</h1>
                        <p class="header-subtitle">Quản lý hồ sơ trang dịch vụ của bạn</p>
                    </div>
                </div>

                @if (TempData["Success"] != null)
                {
                    <div class="alert alert-success alert-dismissible fade show" role="alert">
                        <i class="bi bi-check-circle me-2"></i>
                        @TempData["Success"]
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                }
                @if (TempData["Error"] != null)
                {
                    <div class="alert alert-danger alert-dismissible fade show" role="alert">
                        <i class="bi bi-exclamation-triangle me-2"></i>
                        @TempData["Error"]
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                }

                <!-- Main Profile Card -->
                <div class="profile-main-card">
                    <div class="row g-0">
                        <!-- Left Side - Profile Image -->
                        <div class="col-md-4 col-lg-3">
                            <div class="profile-image-section">
                                <div class="profile-image-wrapper">
                                    @{
                                        var profileImageUrl = !string.IsNullOrEmpty(Model.Images) 
                                            ? ImageHelper.GetImageUrl(Model.Images, Configuration) 
                                            : string.Empty;
                                    }
                                    @if (!string.IsNullOrEmpty(profileImageUrl))
                                    {
                                        <img src="@profileImageUrl" alt="@Model.ProviderName" class="profile-main-image" 
                                             onerror="this.onerror=null; this.src='/images/placeholder-avatar.png'; this.parentElement.innerHTML='<div class=\\'profile-image-placeholder\\'><i class=\\'bi bi-building\\'></i></div>';" />
                                    }
                                    else
                                    {
                                        <div class="profile-image-placeholder">
                                            <i class="bi bi-building"></i>
                                        </div>
                                    }
                                </div>
                                <!-- Status Badge - Nằm dưới ảnh -->
                                <div class="status-badge-container">
                                    @{
                                        var statusLower = Model.Status?.ToLower() ?? "pending";
                                        var statusIcon = statusLower switch
                                        {
                                            "approved" => "bi-check-circle-fill",
                                            "pending" => "bi-clock-fill",
                                            "rejected" => "bi-x-circle-fill",
                                            _ => "bi-question-circle-fill"
                                        };
                                    }
                                    <span class="status-badge-modern status-@statusLower">
                                        <i class="bi @statusIcon"></i>
                                        @GetStatusText(Model.Status)
                                    </span>
                                </div>
                            </div>
                        </div>

                        <!-- Right Side - Provider Info -->
                        <div class="col-md-8 col-lg-9">
                            <div class="profile-details-section">
                                <!-- Provider Name -->
                                <h2 class="provider-name-title">@Model.ProviderName</h2>

                                <!-- Provider ID -->
                                <div class="info-field">
                                    <label class="info-label">
                                        <i class="bi bi-person-badge"></i>
                                        PROVIDER ID
                                    </label>
                                    <div class="info-value-pill">
                                        <span>@Model.ProviderId</span>
                                    </div>
                                </div>

                                <!-- Account Name -->
                                <div class="info-field">
                                    <label class="info-label">
                                        <i class="bi bi-person-circle"></i>
                                        TÊN TÀI KHOẢN
                                    </label>
                                    <div class="info-value-text">@Model.AccountName</div>
                                </div>

                                <!-- Contact Info Row -->
                                <div class="info-field-row">
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <div class="info-field">
                                                <label class="info-label">
                                                    <i class="bi bi-envelope"></i>
                                                    EMAIL
                                                </label>
                                                <div class="info-value-text">@(string.IsNullOrEmpty(Model.Email) ? "Chưa có email" : Model.Email)</div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="info-field info-field-last">
                                                <label class="info-label">
                                                    <i class="bi bi-telephone"></i>
                                                    SỐ ĐIỆN THOẠI
                                                </label>
                                                <div class="info-value-text">@(string.IsNullOrEmpty(Model.PhoneNumber) ? "Chưa có số điện thoại" : Model.PhoneNumber)</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Service Description Card -->
                <div class="profile-description-card">
                    <div class="description-header">
                        <div class="description-header-bar"></div>
                        <h3 class="description-title">Mô Tả Dịch Vụ</h3>
                    </div>
                    <div class="description-content">
                        <p>@(string.IsNullOrEmpty(Model.Description) ? "Chưa có mô tả dịch vụ" : Model.Description)</p>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="profile-actions">
                    <a href="@Url.Action("Edit", "ProviderProfile")" class="btn-action-primary">
                        <i class="bi bi-pencil-square"></i>
                        <span>Chỉnh Sửa Profile</span>
                    </a>
                    <a href="@Url.Action("ChangePassword", "ProviderProfile")" class="btn-action-secondary">
                        <i class="bi bi-shield-lock"></i>
                        <span>Thay Đổi Mật Khẩu</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>